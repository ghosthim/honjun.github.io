title: 添加系列文章功能
author: hojun
avatar: https://cdn.jsdelivr.net/gh/honjun/ImageHosting/sina/006bYVyvgy1ftand2qurdj303c03cdfv.jpg
authorDesc: 一个好奇的人
categories: 技术
series: hexo折腾
comments: true
date: 2018-06-17 11:54:58
authorLink: /about/hojun.html
authorAbout:
tags:
 - hexo
keywords: hexo
description: 给hexo博客添加系列文章功能
photos: https://cdn.jsdelivr.net/gh/honjun/ImageHosting/sina/006bYVyvgy1fs1s79hhsvj30m80b4q8m.jpg
---
![](https://cdn.jsdelivr.net/gh/honjun/ImageHosting/sina/006bYVyvgy1fs1s79hhsvj30m80b4q8m.jpg)

## 前言

因为写了一堆有关于一、二、三等有关的系列文章，而且这些文章写得时间又肯不是连续的。所以hexo的上一篇、下一篇文章功能就不能满足。需要有个系列文章的功能，于是着手实现该需求...*@(坐等)*

一开始的思路就是模仿分类(categories)和标签(tags)，来创建一个系列(series)来实现。为了弄懂分类和标签的生成实现原理还跑hexo的[github仓库](https://github.com/hexojs/hexo)上看了下源代码。辛亏是时间不多，用平时的的空闲时间来实现的，所以没在这条探索HEXO大道的深坑上走的太久。

第二天偶然一次机会让我发现了hexo的二级分类，会在一级分类下新建一个二级分类的文件夹，所有该二级分类的文章都在这个文件夹下。就想借助这个二级分类来实现系列功能。

嗯*@(深思)*...就在我快用二级分类来实现系列文章功能的时候，我发现之前绕了远路*@(喜极而泣)*。

之前是想用分类和标签来遍历出对应的文章。由于没有系列这个变量使用了二级分类来代替...但是我们可以通过遍历文章来显示出有关的系列文章。这种方法就容易实现很多，而且比用二级分类代替更加合理。

## 实现

废话不多说，加下来带大家来实现。在这里只介绍用遍历文章法实现的：

### 第一步
![](https://cdn.jsdelivr.net/gh/honjun/ImageHosting/sina/006bYVyvgy1fsl5ldivjtj3099050mx3.jpg)
在改文件里添加一个series，效果如下：
```conf
title: {{ title }}
date: {{ date }}
author: hojun
avatar: https://cdn.jsdelivr.net/gh/honjun/ImageHosting/sina/006bYVyvgy1ftand2qurdj303c03cdfv.jpg
authorLink: /about/hojun.html 
authorAbout: 
authorDesc: 一个好奇的人
categories: 技术
comments: true
series:
tags: 
keywords: 
description: 
photos: 
---
```
内容看你自己的主题而定，你只需加个series:就行。
这时候你新建的md文件就都有series:这个项了，我们可以在其中填写系列名称。

### 第二步

在md文章中添加series:的值。如：
![](https://cdn.jsdelivr.net/gh/honjun/ImageHosting/sina/006bYVyvgy1fsl5l95lbrj30k60920t9.jpg)

### 第三步

这步才是干货，在主题对应渲染文章的模板文件下添加系列文件显示。
由于博主的主题用的是ejs写的，以下仅给出ejs的代码：
```ejs
<% if (post.series){ %>
    <div class="post-series"><%= post.series %>-<%= __('series') %>：
        <% site.posts.sort('date').map(function(p){  %>
            <% if (post.series == p.series){ %>
                <li><a href="<%- url_for(p.path) %>"><%= p.title %></a></li>
            <% } %>
        <% }) %>
    </div>
<% } %>
```
解释：

 - post.series是该篇文章的系列，即第二步中填的值。
 - if (post.series) 如果有值才调用。
 - site.posts.sort('date').map(function(p){ 将本站所有的文章按日期排序并遍历
 - if (post.series == p.series){ 如果改文章的系列和遍历文章的系列一样，则进入
 - <%- url_for(p.path) %>"><%= p.title %> 显示出满足文章的url路径和文章标题

到此为止系列文章的需求实现了*@(赞一个)*
最终效果如下：